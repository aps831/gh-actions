---
name: Set Up Graalvm Native Image
description: Set up graalvm native image
inputs:
  java-version:
    description: Java version
    required: true
  graalvm-version:
    description: Graalvm version
    required: true
  ACCESS_TOKEN:
    description: Access token
    required: true
runs:
  using: "composite"
  steps:
    - uses: graalvm/setup-graalvm@d3f9e14fc3771c0f5aaccb754e441b946b6703f9 # pin@v1
      with:
        version: "${{ inputs.graalvm-version }}"
        java-version: "${{ inputs.java-version }}"
        components: "native-image"
        github-token: ${{ inputs.ACCESS_TOKEN }}

    - uses: actions/cache@0c45773b623bea8c8e75f6c82b208c3cf94ea4f9 # pin@v3
      with:
        path: ~/.m2/repository
        key: ${{ runner.os }}-maven-${{ hashFiles('**/pom.xml') }}
        restore-keys: |
          ${{ runner.os }}-maven-

    - if: ${{ runner.os == 'Linux' }}
      uses: aps831/gh-actions/install-native-image-linux-dependencies@master

    - if: ${{ runner.os == 'Windows' }}
      uses: aps831/gh-actions/install-native-image-windows-dependencies@master
